#!/usr/bin/env bash

set -euo pipefail

free=$(free -h | grep '^Mem:' | sed -e 's:\s\+: :g' | cut -d' ' -f2)

# find the closest actual ram size, rounding up
guess=1 # start guess at 1Gi

if [[ ${free: -2} = Gi ]]; then
    memsize=${free%Gi}
    memsize=${memsize%.*}
    while ((guess < memsize)); do
        # double guess each iteration:
        ((guess *= 2)) # 2 4 8 16 32 64
    done
fi

echo "${guess}G"
