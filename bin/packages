#!/usr/bin/env bash

set -euo pipefail

cd "$BOOTSTRAP_CONFIG_DIR"/packages

cat base

if [[ -v BOOTSTRAP_USE_LUKS ]]; then
    cat luks
fi

if [[ -v BOOTSTRAP_USE_WIRELESS ]]; then
    cat wireless
fi

if [[ -v BOOTSTRAP_BOOT_FIRMWARE_PACKAGE_FILE ]]; then
    cat "$BOOTSTRAP_BOOT_FIRMWARE_PACKAGE_FILE"
fi

if [[ -v BOOTSTRAP_CPU_VENDOR_PACKAGE_FILE ]]; then
    cat "$BOOTSTRAP_CPU_VENDOR_PACKAGE_FILE"
fi

if [[ -v BOOTSTRAP_PACKAGES ]]; then
    read -ra packages <<<"$BOOTSTRAP_PACKAGES"
    printf "%s\n" "${packages[@]}"
fi

if [[ -f extra ]]; then
    cat extra
fi
