#!/usr/bin/env bash

set -euo pipefail

cd "$BOOTSTRAP_CONFIG"/packages

cat base "$BOOTSTRAP_BOOT_FIRMWARE"

printf "linux%s\n" "${BOOTSTRAP_KERNEL:+-$BOOTSTRAP_KERNEL}"

if [[ -v BOOTSTRAP_USE_LUKS ]]; then
    cat luks
fi

if [[ -v BOOTSTRAP_USE_WIRELESS ]]; then
    cat wireless
fi

if [[ -v BOOTSTRAP_CPU_VENDOR ]]; then
    cat "$BOOTSTRAP_CPU_VENDOR"
fi

if [[ -v BOOTSTRAP_ADMIN_SHELL ]]; then
    printf "%s\n" "${BOOTSTRAP_ADMIN_SHELL##*/}"
fi

if [[ -f extra ]]; then
    cat extra
fi
