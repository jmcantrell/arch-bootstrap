#!/usr/bin/env bash

set -euo pipefail

config_file=${1:?missing config file}
value=${2:-0}

config_key=ParallelDownloads

sed_opts=(-e "/^#$config_key\\b/s/#//")

if [[ $value =~ ^[[:digit:]]+$ ]] && ((value > 0)); then
    sed_opts+=(-e "/^$config_key\\b/s/[[:digit:]]\+/$value/")
fi

sed -i "${sed_opts[@]}" "$config_file"
