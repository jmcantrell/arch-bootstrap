#!/usr/bin/env bash

set -euo pipefail

config_file=${1:?missing config file}
value=${2:-0}

config_key=ParallelDownloads

options=(-e "/^#$config_key\\b/s/#//")

if [[ $value =~ ^[[:digit:]]+$ ]] && ((value > 0)); then
    options+=(-e "/^$config_key\\b/s/[[:digit:]]\+/$value/")
fi

sed -i "${options[@]}" "$config_file"
