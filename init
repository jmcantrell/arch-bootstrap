root_dir=$(dirname "$(readlink -f -- "$0")")

export BOOTSTRAP_ROOT_DIR=$root_dir
export BOOTSTRAP_LIB_DIR=$BOOTSTRAP_ROOT_DIR/lib
export BOOTSTRAP_CONFIG_DIR=$BOOTSTRAP_ROOT_DIR/config

export PATH=$BOOTSTRAP_ROOT_DIR/bin:$PATH

source "$BOOTSTRAP_LIB_DIR"/init/base.bash

if [[ -v BOOTSTRAP_ENABLE_LUKS ]]; then
    source "$BOOTSTRAP_LIB_DIR"/init/luks.bash
fi

if [[ -v BOOTSTRAP_ENABLE_LVM ]]; then
    source "$BOOTSTRAP_LIB_DIR"/init/lvm.bash
fi

if [[ -v BOOTSTRAP_ENABLE_SWAP ]]; then
    source "$BOOTSTRAP_LIB_DIR"/init/swap.bash
fi

export BOOTSTRAP_BOOT_DEVICE=$BOOTSTRAP_PART_BOOT_DEVICE

if [[ -v BOOTSTRAP_ENABLE_LVM ]]; then
    export BOOTSTRAP_ROOT_DEVICE=$BOOTSTRAP_LVM_LV_ROOT_MAPPER_DEVICE
elif [[ -v BOOTSTRAP_ENABLE_LUKS ]]; then
    export BOOTSTRAP_ROOT_DEVICE=$BOOTSTRAP_LUKS_MAPPER_DEVICE
else
    export BOOTSTRAP_ROOT_DEVICE=$BOOTSTRAP_PART_SYS_DEVICE
fi

if [[ -v BOOTSTRAP_ENABLE_SWAP ]]; then
    if [[ -v BOOTSTRAP_ENABLE_LVM ]]; then
        export BOOTSTRAP_SWAP_DEVICE=$BOOTSTRAP_LVM_LV_SWAP_MAPPER_DEVICE
    else
        export BOOTSTRAP_SWAP_DEVICE=$BOOTSTRAP_PART_SWAP_DEVICE
    fi
fi

# vi:ft=bash
