#!/usr/bin/env bash

set -euo pipefail

localize

partition

if [[ -v INSTALL_DEVICE_USE_LUKS ]]; then
    luks-format
    luks-open
fi

lvm-create

swap-create
swap-open

fs-format
fs-mount

if [[ -v INSTALL_DEVICE_USE_LUKS ]]; then
    luks-addkey
fi

packages-install
chroot-install
initrd-install
boot-install
